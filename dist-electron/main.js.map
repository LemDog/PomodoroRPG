{"version":3,"sources":["../electron/main.ts","../electron/backend/Logger.ts","../electron/backend/types.ts","../electron/backend/GameService.ts"],"sourcesContent":["import { app, BrowserWindow, ipcMain, Menu } from 'electron'\nimport path from 'path'\nimport { GameService } from './backend/GameService'\n\n// Handle creating/removing shortcuts on Windows when installing/uninstalling.\n// if (require('electron-squirrel-startup')) {\n//     app.quit()\n// }\n\n// Initialize Game Service (Backend Logic)\nconst gameService = new GameService();\n\nconst createWindow = () => {\n    // Create the browser window.\n    const mainWindow = new BrowserWindow({\n        width: 1000,\n        height: 800,\n        minWidth: 800,\n        minHeight: 600,\n        webPreferences: {\n            preload: path.join(__dirname, 'preload.js'),\n            nodeIntegration: false,\n            contextIsolation: true, // Secure IPC\n        },\n    })\n\n    // Create Application Menu\n    const menuTemplate = [\n        {\n            label: 'File',\n            submenu: [\n                {\n                    label: 'Enable Test Mode',\n                    type: 'checkbox',\n                    checked: true,\n                    click: (menuItem: any) => {\n                        mainWindow.webContents.send('toggle-debug-mode', menuItem.checked);\n                    }\n                },\n                { type: 'separator' },\n                { role: 'quit' }\n            ]\n        },\n        { role: 'editMenu' },\n        { role: 'viewMenu' },\n        { role: 'windowMenu' }\n    ];\n\n    // @ts-ignore\n    const menu = Menu.buildFromTemplate(menuTemplate);\n    Menu.setApplicationMenu(menu);\n\n    // Register State Updates\n    gameService.registerStateCallback((state) => {\n        // Send to renderer\n        if (!mainWindow.isDestroyed()) {\n            mainWindow.webContents.send('game-state-update', state);\n        }\n    });\n\n    // In dev, load valid local URL. In prod, load index.html from dist\n    mainWindow.loadURL('http://localhost:5173').catch(() => {\n        // If failed, maybe we are in prod builds\n        mainWindow.loadFile(path.join(__dirname, '../dist/index.html'))\n    })\n}\n\n// IPC Handlers\nipcMain.handle('game:getState', () => {\n    return gameService.getState();\n});\n\nipcMain.handle('game:startGame', () => {\n    gameService.startGame();\n    return gameService.getState();\n});\n\nipcMain.handle('game:stopGame', () => {\n    gameService.stopGame();\n    return gameService.getState();\n});\n\n// Debug Handlers\nipcMain.handle('game:debugAddXp', (_, amount) => {\n    gameService.debugAddXp(amount);\n    return gameService.getState();\n});\n\nipcMain.handle('game:debugTriggerEvent', () => {\n    gameService.debugTriggerEvent();\n    return gameService.getState();\n});\n\napp.on('ready', createWindow)\n\napp.on('will-quit', () => {\n    gameService.stopGame();\n})\n\napp.on('window-all-closed', () => {\n    if (process.platform !== 'darwin') {\n        app.quit()\n    }\n})\n\napp.on('activate', () => {\n    if (BrowserWindow.getAllWindows().length === 0) {\n        createWindow()\n    }\n})\n","export enum LogLevel {\n    INFO = 'INFO',\n    WARN = 'WARN',\n    ERROR = 'ERROR',\n    DEBUG = 'DEBUG',\n}\n\nexport class Logger {\n    private scope: string;\n\n    constructor(scope: string) {\n        this.scope = scope;\n    }\n\n    private format(level: LogLevel, message: string, meta?: any) {\n        const timestamp = new Date().toISOString();\n        return `[${timestamp}] [${level}] [${this.scope}]: ${message} ${meta ? JSON.stringify(meta) : ''}`;\n    }\n\n    info(message: string, meta?: any) {\n        console.log(this.format(LogLevel.INFO, message, meta));\n    }\n\n    warn(message: string, meta?: any) {\n        console.warn(this.format(LogLevel.WARN, message, meta));\n    }\n\n    error(message: string, meta?: any) {\n        console.error(this.format(LogLevel.ERROR, message, meta));\n    }\n\n    debug(message: string, meta?: any) {\n        console.debug(this.format(LogLevel.DEBUG, message, meta));\n    }\n}\n","export interface Stats {\n    coding: number; // Attack power\n    focus: number;  // Defense / Stability\n    energy: number; // HP\n}\n\nexport interface Equipment {\n    head?: string;\n    body?: string;\n    weapon?: string;\n}\n\nexport interface Hero {\n    name: string;\n    level: number;\n    currentXp: number;\n    requiredXp: number;\n    stats: Stats;\n    equipment: Equipment;\n    inventory: string[];\n}\n\nexport interface GameState {\n    hero: Hero;\n    timer: {\n        timeLeft: number; // in seconds\n        isActive: boolean;\n        mode: 'WORK' | 'BREAK';\n    };\n    currentAction: string; // e.g., \"Fighting bug\", \"Refactoring\", \"Coffee break\"\n}\n\nexport const INITIAL_HERO: Hero = {\n    name: \"Little Guy\",\n    level: 1,\n    currentXp: 0,\n    requiredXp: 100,\n    stats: {\n        coding: 5,\n        focus: 5,\n        energy: 100,\n    },\n    equipment: {},\n    inventory: [],\n};\n","import { Logger } from './Logger';\nimport { GameState, Hero, INITIAL_HERO } from './types';\n\nexport class GameService {\n    private logger: Logger;\n    private state: GameState;\n    private intervalId: NodeJS.Timeout | null = null;\n    private onStateChange: ((state: GameState) => void) | null = null;\n\n    constructor() {\n        this.logger = new Logger('GameService');\n        this.state = {\n            hero: { ...INITIAL_HERO },\n            timer: {\n                timeLeft: 25 * 60,\n                isActive: false,\n                mode: 'WORK',\n            },\n            currentAction: 'Idle'\n        };\n        this.logger.info('GameService initialized');\n    }\n\n    public registerStateCallback(callback: (state: GameState) => void) {\n        this.onStateChange = callback;\n    }\n\n    private emitState() {\n        if (this.onStateChange) {\n            this.onStateChange(this.state);\n        }\n    }\n\n    public getState(): GameState {\n        return this.state;\n    }\n\n    public startGame() {\n        if (this.state.timer.isActive) return;\n\n        this.logger.info('Starting mission');\n        this.state.timer.isActive = true;\n        this.state.currentAction = 'Starting Mission...';\n        this.emitState();\n\n        this.intervalId = setInterval(() => this.tick(), 1000);\n    }\n\n    public stopGame() {\n        if (!this.state.timer.isActive) return;\n\n        this.logger.info('Stopping mission (Retreat)');\n        this.state.timer.isActive = false;\n        this.state.currentAction = 'Retreated to Camp';\n        if (this.intervalId) {\n            clearInterval(this.intervalId);\n            this.intervalId = null;\n        }\n        this.emitState();\n    }\n\n    private tick() {\n        if (this.state.timer.timeLeft <= 0) {\n            this.completeSession();\n            return;\n        }\n\n        this.state.timer.timeLeft -= 1;\n\n        // RPG Logic: 1 XP per second of work\n        this.state.hero.currentXp += 1;\n        this.checkLevelUp();\n\n        // Random Events\n        if (Math.random() < 0.05) {\n            const actions = ['Fighting Bug', 'Optimizing', 'Googling Error', 'Drinking Coffee', 'Refactoring'];\n            this.state.currentAction = actions[Math.floor(Math.random() * actions.length)];\n        }\n\n        this.emitState();\n    }\n\n    private checkLevelUp() {\n        if (this.state.hero.currentXp >= this.state.hero.requiredXp) {\n            this.state.hero.level += 1;\n            this.state.hero.currentXp -= this.state.hero.requiredXp;\n            this.state.hero.requiredXp = Math.floor(this.state.hero.requiredXp * 1.5);\n            this.logger.info(`Level Up! New Level: ${this.state.hero.level}`);\n        }\n    }\n\n    private completeSession() {\n        this.logger.info('Session Complete');\n        this.state.timer.isActive = false;\n        this.state.timer.timeLeft = 0;\n        this.state.currentAction = 'Mission Complete! Loot found.';\n\n        if (this.intervalId) {\n            clearInterval(this.intervalId);\n            this.intervalId = null;\n        }\n        this.emitState();\n    }\n\n    // --- Debug / Test Mode Methods ---\n    public debugAddXp(amount: number) {\n        this.logger.info(`[DEBUG] Adding ${amount} XP`);\n        this.state.hero.currentXp += amount;\n        this.checkLevelUp();\n        this.emitState();\n    }\n\n    public debugTriggerEvent() {\n        this.logger.info('[DEBUG] Triggering Random Event');\n        const actions = ['Fighting Bug', 'Optimizing', 'Googling Error', 'Drinking Coffee', 'Refactoring'];\n        this.state.currentAction = actions[Math.floor(Math.random() * actions.length)];\n        this.emitState();\n    }\n}\n"],"mappings":"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","names":["path"]}